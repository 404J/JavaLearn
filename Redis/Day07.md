# Day07

## 解决容量有限问题

* 方案一(数据可以分类)：多个 redis 节点，存放根据业务拆分的数据。client 根据拆分逻辑访问不同的 redis
* 方案二(数据无法分分类)：根据某些算法(hash + 取模) 数据存放多个 redis。后期无法更改取模数据，扩展性差,可以取模后的值比节点多，一个节点可以 mapping 多个取模的值（槽位）。当节点增加的时候，相应槽位的数据需要迁移
* 方案三(数据无法分分类)：数据随机存放多个 redis。用于消费队列
* 方案四(数据无法分分类)：一致性 hash 算法，data 和 node 做 hash, 详见课件图示

以上方案都是客户端直连 redis, 成本高。中间可以添加代理 proxy（nginx）,中间代理层做数据分发逻辑。

> github: twemproxy， predixy

## redis 的数据分片

> 数据分治带来的问题：
聚合操作很难操作，事务也很难实现。使用 hash tag 人为让数据放在一起
